<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
	<title>LowBattery自动改电量</title>
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<script src="../../../js/wx-sdk.js?v=20170613"></script>
	<script src="../../../js/statistic.js"></script>
	<script src="https://cdn.bootcss.com/clipboard.js/2.0.0/clipboard.min.js"></script>
	<script>
	  (adsbygoogle = window.adsbygoogle || []).push({
		google_ad_client: "ca-pub-2093034756983913",
		enable_page_level_ads: true
	  });
	</script>
	<style type="text/css">
		body {
			background: url("/images/lowbattery/bg-re.png");
			margin: 0;
		}
		.content {
			width: 100%;
			height: 100%;
			position: absolute;
		}
		.blur {
    		filter: url(blur.svg#blur); /* IE10, IE11 */
    		-webkit-filter: blur(10px); /* Chrome, Opera */
       		-moz-filter: blur(10px);
        	-ms-filter: blur(10px);   
            filter: blur(10px);
    		filter: progid:DXImageTransform.Microsoft.Blur(PixelRadius=10, MakeShadow=false); /* IE6~IE9 */
		}
		.close{
			position: absolute;width: 15%;left:43%;top:88%;
		}
		.hide{display: none;}
	</style>
</head>
<body>			
	<input id="foo" style="opacity: 0;position: absolute;left:0;top:0;z-index: -9999" value="支付宝发红包啦！人人可领，天天可领！长按复制此消息，打开支付宝领红包！fzh5An83Bw">
	<button class="btn" style="display:none" class="hide" data-clipboard-target="#foo"></button>
	<div class="content p1" style="z-index: 0">
		<div style="height: 80%;width: 60%;position: relative;margin-left: 20%;margin-top: 0%;">
			<img id="mainbutton" alt="" src="/images/lowbattery/battery.png" width="100%" style="bottom:0;position: absolute;">
			<span style="position: absolute;top: 90%;font-size: 5em;color: #6b69a2;left: 40%;font-family: 微软雅黑;"><font id="percent">10</font>%</span>
			<div id="battery" style="width:100%;position: absolute;background-color: red;height: 10%;bottom:2px;opacity: 0.1;border-top-left-radius:15px;border-top-right-radius:15px;"></div>
		</div>
		<div style="width:60%;margin-top: 8%;margin-left: auto;margin-right: auto;height: 9%;">
			<div style="width: 25%;text-align: center;float:left;">
				<img id="qrbtn" alt="" src="/images/lowbattery/button_qr.png" width="65%">
			</div>
			<div style="width: 25%;text-align: center;float:left;">
				<img id="momentsbtn" alt="" src="/images/lowbattery/button_moments.png" width="65%">
			</div>
			<div style="width: 25%;text-align: center;float:left;">
				<img id="questionbtn" alt="" src="/images/lowbattery/button_question.png" width="65%">
			</div>
			<div style="width: 25%;text-align: center;float:left;">
				<img id="infobtn" alt="" src="/images/lowbattery/button_info.png" width="65%">
			</div>
		</div>
		<div style="width:100%;margin-left: auto;margin-right: auto;text-align: center;">
			<img alt="" src="/images/lowbattery/only_for_ios.png" width="27%">
		</div>
	</div>
	<div class="content pg1 hide" style="width: 100%;height: 100%;position: relative;">
		<div style="width:100%;text-align: center;"><img alt="" src="/images/lowbattery/page1.png" width="70%"></div>
		<img class="close" alt="" src="/images/lowbattery/close.png">
	</div>
	<div class="content pg2 hide" style="width: 100%;height: 100%;position: relative;">
		<div style="width:100%;text-align: center;"><img alt="" src="/images/lowbattery/page2.png" width="70%"></div>
		<img class="close" alt="" src="/images/lowbattery/close.png">
	</div>
	<div class="content pg3 hide" style="width: 100%;height: 100%;position: relative;">
		<div style="width:100%;text-align: center;"><img alt="" src="/images/lowbattery/page3.png" width="70%"></div>
		<img class="close" alt="" src="/images/lowbattery/close.png">
	</div>
	<div class="content pg4 hide" style="width: 100%;height: 100%;position: relative;">
		<div style="width:100%;text-align: center;"><img alt="" src="/images/lowbattery/page4.png" width="70%"></div>
		<img class="close" alt="" src="/images/lowbattery/close.png">
	</div>
	<script type="text/javascript">
		wxShare({
			shareUrl : window.location.href,
			shareTitle : "LowBattery自动改电量",
			shareDesc : "帮你快速结束无聊的对话。",
			shareImg : "http://lowbattery.leizhenxd.com/images/lowbattery/share.png",
			pageType: "lowbattery",
			callback : function(){
				visit("lowbattery","lowbattery_share");
			}
		});
		$("#mainbutton").click(function(){
			copy();
			console.log({"percent":parseInt($("#percent").text())});
			wxUploadImg({
				pageType: "lowbattery",
				uploadUrl: "../../wxapp/uploadServerId.htm",
				data: {"percent":parseInt($("#percent").text())},
				success : function(data) {
					if(data != null && data.indexOf("http") != 0) {
						$.ajax({url:"../../wxapp/test.htm?text="+encodeURI(JSON.stringify(data)),async:false});
						console.log(data);
						alert(JSON.stringify(data));
						return ;
					}
					wxPreviewImg({
						urls : [data]
					});
				}
			});
		});
		
		visit("lowbattery","lowbattery_visit");
		
		$("#qrbtn").click(function(){
			copy();
			$(".p1").addClass("blur");
			$(".pg1").show();
		});
		$("#momentsbtn").click(function(){
			copy();
			$(".p1").addClass("blur");
			$(".pg2").show();
		});
		$("#questionbtn").click(function(){
			copy();
			$(".p1").addClass("blur");
			$(".pg3").show();
		});
		$("#infobtn").click(function(){
			copy();
			$(".p1").addClass("blur");
			$(".pg4").show();
		});
		$(".close").click(function(){
			copy();
			$(this).parent().hide();
			$(".p1").removeClass("blur");
		});
	</script>
	
	<script>
	var startPoint = null,startPercent = null;
	
	$("body")[0].addEventListener('touchmove', function(event) {
		event.preventDefault();
	});
	var obj = document.getElementById('mainbutton');
	obj.addEventListener('touchmove', function(event) {
	     // 如果这个元素的位置内只有一个手指的话
	    if (event.targetTouches.length == 1) {
	　　　　 event.preventDefault();// 阻止浏览器默认事件，重要 
	        var touch = event.targetTouches[0];
	        if(startPoint == null) startPoint = touch.pageY;
	        if(startPercent == null) startPercent = parseInt($("#percent").text());
	        else {
	        	console.log(parseInt((touch.pageY-startPoint)/50)+"-"+$("#percent").text());
	        	var add = parseInt((startPoint - touch.pageY)/100);
	        	if(startPercent < 1 || startPercent > 10) return ;
	        	if((startPercent+add)<=0) $("#percent").text(1);
	        	else if((startPercent+add) > 10) $("#percent").text(10);
	        	else $("#percent").text(startPercent+add);
	        	$("#battery").css("height", parseInt($("#percent").text())+"%");
	        }
	     }
	}, false);
	obj.addEventListener('touchstart', function(event) {

	});
	obj.addEventListener('touchend', function(event) {
		startPoint = null;
		startPercent = parseInt($("#percent").text());
	});
	new ClipboardJS('.btn');
	var isCopyed = false;
	function copy(){
		if(!isCopyed) {
			$(".btn").click();
		}
	}
	</script>
</body>
</html>